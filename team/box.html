<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        td{
            border: solid 1px;
            border-collapse: collapse;
            padding: 4px;
        }
        .error {
            background-color: red;
        }
    </style>
</head>
<body>
    <table>

    </table>
    <button>validate</button>
</body>
<script>
    let size, values;
    let button = document.querySelector('button');
    let resultRows = [];
    let resultBoxs = [];

    let tablePop = (values) => {
        const table = document.querySelector("table");
        for(let rowidx in values){
            let tr = document.createElement("tr");
            for(let colIdx in values[rowidx]){
                let td = document.createElement("td");
                td.innerHTML = values[rowidx][colIdx];
                td.classList = 'true';
                tr.appendChild(td);
            }
            table.appendChild(tr);
        }
    }
    
    
    button.addEventListener('click',function(){
        let tr = document.querySelectorAll('tr');
        for( let y =0; y< resultRows.length; y++){
            let res = resultRows[y];
            tr[res[0]].children[res[1]].classList += ' error';
        }
    })


    function loadJson(){
        const xmlHTTP = new XMLHttpRequest();
        xmlHTTP.onload = function(){
            output = JSON.parse(this.responseText)[0];
            size = output.size;
            values = output.values;
            validateRows(output);
            validateBoxs(output);
            tablePop(values,resultRows);

        }
        xmlHTTP.open("GET","./source.json",true);
        xmlHTTP.send();
    }
    loadJson();
    


    function validateRows(board){
    let size = board.size;
    let val = board.values;
	// Rows
	for (let q = 0; q < size; q++){
		for (let i = 0; i < size; i++){
            for (let j = i+1; j < size; j++){
                if(val[q][i] == val[q][j]){
                    resultRows.push({0: q, 1:j});
                    resultRows.push({0: q, 1:i});
                }
            }
        }
	}
    return resultRows;
    }

    function validateBoxs(board){
    let size = board.size;
    let sq = Math.sqrt(size); 
    let val = board.values;
    let num = 0;
    let colnum;
    let rownum;
    for(let p = p*sq; p < sq ; p++){
        for (let q = 0; q < sq ; q++){
                num = val[p][q];
                console.log(num);
            for (let i = 0; i < sq; i++){
                for (let j = i+1; j < sq; j++){
                    console.log(num[i]);
                    console.log(num[j]);
                    // if(num[i] == num[j]){
                    //     colnum = sq * p + j % sq;
                    //     rownum = sq + q + i % sq;
                    //     resultBoxs.push({colnum, rownum})
                    // }
                }
            }
        }
    }
    // console.log(resultBoxs);
    return resultBoxs;
    }

    

// [1, 8, 7, 4, 9, 3, 6, 5, 2],
// [6, 4, 3, 1, 2, 5, 8, 9, 7],
// [2, 5, 9, 7, 8, 6, 3, 1, 4],

// [7, 1, 4, 2, 3, 8, 5, 6, 9],
// [9, 6, 8, 5, 7, 1, 4, 2, 3],
// [5, 3, 2, 6, 4, 9, 1, 7, 8],

// [8, 7, 6, 9, 1, 4, 2, 3, 5],
// [4, 9, 1, 3, 5, 2, 7, 8, 6],
// [3, 2, 5, 8, 6, 7, 9, 4, 1]


	
	// Squares
	// for (var s = 0; s < 9; ++s){
	// 	for (var c1 = 0; c1 < 8; ++c1){
	// 		var x1 = 3 * (s % 3) + (c1 % 3);
	// 		var y1 = 3 * Math.floor(s / 3) + Math.floor(c1 / 3);
	// 		if (board[y1][x1] != 0){
	// 			for (var c2 = c1 + 1; c2 < 9; ++c2){
	// 				var x2 = 3 * (s % 3) + (c2 % 3);
	// 				var y2 = 3 * Math.floor(s / 3) + Math.floor(c2 / 3);
	// 				if (board[y1][x1] == board[y2][x2]){
	// 					return y2, x2;
	// 				}
	// 			}
	// 		}
	// 	}
	// }
	
</script>
</html>